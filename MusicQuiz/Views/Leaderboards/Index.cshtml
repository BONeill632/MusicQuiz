@model MusicQuiz.Web.Models.Leaderboards.LeaderboardViewModel
@{
    ViewData["Title"] = "Leaderboards";
}

<h1>@ViewData["Title"]</h1>
<hr />
<p>Welcome to the Leaderboards page. Here you can see the top scores and rankings for the Music Quiz.</p>

<h3 class="centered">Top 10 Users - @(Model.SelectedAcademicYear)</h3>

@if (Model.TopUsers != null && Model.TopUsers.Any())
{
    <table class="table table-modern">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Name</th>
                <th>EXP</th>
            </tr>
        </thead>
        <tbody>
            @for (int i = 0; i < Model.TopUsers.Count; i++)
            {
                var user = Model.TopUsers[i];
                string rowClass = user.IntID == Model.CurrentUser?.IntID ? "row-primary" : "";

                string rankClass = "";
                string trophy = "";

                if (i == 0)
                {
                    rankClass = "gold-rank";
                    trophy = "🏆";
                }
                else if (i == 1)
                {
                    rankClass = "silver-rank";
                    trophy = "🥈";
                }
                else if (i == 2)
                {
                    rankClass = "bronze-rank";
                    trophy = "🥉";
                }

                <tr class="@rankClass @rowClass">
                    <td>@(i + 1)</td>
                    <td class="rank-name">@trophy @user.FirstName @user.LastName</td>
                    <td>@user.EXP</td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p class="text-center">No data to display. It looks like no users have registered for this year</p>
}

<form method="post" style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
    @foreach (var year in Model.AcademicYearOptions)
    {
        <button type="submit" name="academicYear" value="@year" class="btn btn-danger @(year == Model.SelectedAcademicYear ? "active" : "")">
            @year
        </button>
    }
</form>

<hr />

@if (Model.CurrentUser != null)
{
    <h3 class="centered">Your Current Data</h3>

    <table class="table table-modern">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Name</th>
                <th>EXP</th>
                <th>Academic Year</th>
            </tr>
        </thead>
        <tbody>
            <tr class="row-primary">
                <td>@(Model.UserRank != -1 ? Model.UserRank : "Not Ranked")</td>
                <td><strong class="font-weight-bold">@Model.CurrentUser?.FirstName @Model.CurrentUser?.LastName</strong></td>
                <td><strong class="font-weight-bold">@Model.CurrentUser?.EXP</strong></td>
                <td>@Model.CurrentUser?.AcademicYear</td>
            </tr>
        </tbody>
    </table>
}
else
{
    <h2 class="centered">Your data</h2>
    <h3 class="text-center text-red-bold">OOPS!</h3>
    <p class="text-center">It looks like you aren't logged in yet. Click here to get started!</p>

    <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
        <a class="btn btn-danger btn-lg" asp-area="Identity" asp-page="/Account/Register">Register</a>
        <a class="btn btn-danger btn-lg" asp-area="Identity" asp-page="/Account/Login">Login</a>
    </div>
}
