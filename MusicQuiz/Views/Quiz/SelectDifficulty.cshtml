@model MusicQuiz.Web.Models.Home.MusicQuizViewModel
@{
    ViewData["Title"] = "Difficulty select";
}
@section Scripts {
    <script src="~/js/selectDifficulty.js"></script>

    @* will not work when in any JS file *@
    <script>
        function selectOption(difficulty, className) {
            document.getElementById("selectedDifficulty").value = difficulty;
            var options = document.getElementsByClassName(className);
            for (var i = 0; i < options.length; i++) {
                options[i].classList.remove("selected");
            }
            document.getElementById(difficulty).classList.add("selected");
            document.getElementById("submitButton").disabled = false;
        }

        function validateForm() {
            var selectedDifficulty = document.getElementById("selectedDifficulty").value;
            if (!selectedDifficulty) {
                alert("Please select a difficulty level.");
                return false;
            }
            return true;
        }
    </script>
}
<h1>Quiz</h1>
<hr />

<h2 class="centered">Before you proceed</h2>

<div class="center-content">
    <p>This is the practice quiz section. Here, you can try all the questions we have to offer.</p>

    <p>There are a number of things you might want to note.</p>
    <ol class="info-list">
        <li>
            There is a pool of questions for each topic. Each quiz is randomized.
        </li>
        <li>
            The answers to the quiz are in a random order, so you can't predict where the next answer will be.
        </li>
        <li>
            EXP/percentage will greatly vary. As this is a practice quiz, you will get the following points per answer attempt:
            <ul class="exp-list">
                <li>
                    Attempt 1: @(MusicQuiz.Core.Enums.EXP.One.ToString("D")) EXP / Full marks
                </li>
                <li>
                    Attempt 2: @(MusicQuiz.Core.Enums.EXP.Two.ToString("D")) EXP / 1/2 marks
                </li>
                <li>
                    Attempt 3: @(MusicQuiz.Core.Enums.EXP.Three.ToString("D")) EXP / 1/3 marks
                </li>
                <li>
                    Attempt 4/Incorrect: @(MusicQuiz.Core.Enums.EXP.Default.ToString("D")) EXP / 0 marks
                </li>

            </ul>
        </li>
    </ol>
</div>

<hr />

<h2 class="centered">Select a difficulty</h2>

<form method="post" action="/Quiz/Start" onsubmit="return validateForm()">
    <ul class="quiz-options-list">
        @foreach (var difficulty in Model.Difficulty)
        {
            var isDisabled = (User.Identity == null || !User.Identity.IsAuthenticated) && difficulty.DifficultyLevel != MusicQuiz.Core.Enums.DifficultyLevel.Easy;
            if (isDisabled)
            {
                <li>
                    <div class="quiz-option text-center disabled" id="@difficulty.DifficultyLevel">
                        <i class="fas fa-lock"></i> @difficulty.Description
                        <p>Please log in or create an account to access these levels.</p>
                    </div>
                </li>
            }
            else
            {
                <li>
                    <div class="quiz-option text-center" id="@difficulty.DifficultyLevel" onclick="selectOption('@difficulty.DifficultyLevel', 'quiz-option')">
                        @difficulty.Description
                    </div>
                </li>
            }
        }
    </ul>
    <input type="hidden" id="selectedTopic" name="selectedTopic" value="@Model.SelectedTopic" />
    <input type="hidden" id="selectedDifficulty" name="selectedDifficulty" value="@Model.SelectedDifficulty" />
    <div class="d-flex flex-column align-items-center" style="width: 100%;">
        <button type="submit" id="submitButton" class="btn btn-danger w-100 mb-2" style="max-width: 300px;" disabled>Start Quiz</button>
        <a asp-action="Index" class="btn btn-secondary w-100" style="max-width: 300px;">Back</a>
    </div>
</form>